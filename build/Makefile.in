# Makefile.in generated by automake 1.10 from Makefile.am.
# @configure_input@

# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
# This Makefile.in is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.

@SET_MAKE@
VPATH = @srcdir@
pkgdatadir = $(datadir)/@PACKAGE@
pkglibdir = $(libdir)/@PACKAGE@
pkgincludedir = $(includedir)/@PACKAGE@
am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
install_sh_DATA = $(install_sh) -c -m 644
install_sh_PROGRAM = $(install_sh) -c
install_sh_SCRIPT = $(install_sh) -c
INSTALL_HEADER = $(INSTALL_DATA)
transform = $(program_transform_name)
NORMAL_INSTALL = :
PRE_INSTALL = :
POST_INSTALL = :
NORMAL_UNINSTALL = :
PRE_UNINSTALL = :
POST_UNINSTALL = :
build_triplet = @build@
host_triplet = @host@
subdir = build
DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
am__aclocal_m4_deps = $(top_srcdir)/acinclude.m4 \
	$(top_srcdir)/configure.ac
am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
	$(ACLOCAL_M4)
mkinstalldirs = $(install_sh) -d
CONFIG_CLEAN_FILES =
SOURCES =
DIST_SOURCES =
DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
ACLOCAL = @ACLOCAL@
AMTAR = @AMTAR@
AUTOCONF = @AUTOCONF@
AUTOHEADER = @AUTOHEADER@
AUTOMAKE = @AUTOMAKE@
AWK = @AWK@
BASENAME = @BASENAME@
BUILDROOT = @BUILDROOT@
BUNZIP2 = @BUNZIP2@
CAT = @CAT@
CHMOD = @CHMOD@
CHOWN = @CHOWN@
CP = @CP@
CYGPATH_W = @CYGPATH_W@
DEFS = @DEFS@
ECHO = @ECHO@
ECHO_C = @ECHO_C@
ECHO_N = @ECHO_N@
ECHO_T = @ECHO_T@
FIND = @FIND@
GREP = @GREP@
GROUPADD = @GROUPADD@
GUNZIP = @GUNZIP@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_SCRIPT = @INSTALL_SCRIPT@
INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
LIBOBJS = @LIBOBJS@
LIBS = @LIBS@
LN = @LN@
LN_S = @LN_S@
LTLIBOBJS = @LTLIBOBJS@
M4 = @M4@
MAKEINFO = @MAKEINFO@
MKDIR = @MKDIR@
MKDIR_P = @MKDIR_P@
PACKAGE = @PACKAGE@
PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
PACKAGE_NAME = @PACKAGE_NAME@
PACKAGE_STRING = @PACKAGE_STRING@
PACKAGE_TARNAME = @PACKAGE_TARNAME@
PACKAGE_VERSION = @PACKAGE_VERSION@
PATCH = @PATCH@
PATH_SEPARATOR = @PATH_SEPARATOR@
PERL = @PERL@
SED = @SED@
SENDMAILUSER = @SENDMAILUSER@
SET_MAKE = @SET_MAKE@
SHELL = @SHELL@
SMSUBMITUSER = @SMSUBMITUSER@
STRIP = @STRIP@
SYSTEMNAME = @SYSTEMNAME@
SYSVERSION = @SYSVERSION@
TAR = @TAR@
TARGET_DOMAINNAME = @TARGET_DOMAINNAME@
TARGET_FQDN = @TARGET_FQDN@
TARGET_HOSTNAME = @TARGET_HOSTNAME@
TARGET_OSTYPE = @TARGET_OSTYPE@
TOUCH = @TOUCH@
USERADD = @USERADD@
VERSION = @VERSION@
VIRTMAILUSER = @VIRTMAILUSER@
WGET = @WGET@
abs_builddir = @abs_builddir@
abs_srcdir = @abs_srcdir@
abs_top_builddir = @abs_top_builddir@
abs_top_srcdir = @abs_top_srcdir@
am__leading_dot = @am__leading_dot@
am__tar = @am__tar@
am__untar = @am__untar@
bindir = @bindir@
build = @build@
build_alias = @build_alias@
build_cpu = @build_cpu@
build_os = @build_os@
build_vendor = @build_vendor@
builddir = @builddir@
datadir = @datadir@
datarootdir = @datarootdir@
docdir = @docdir@
dvidir = @dvidir@
exec_prefix = @exec_prefix@
host = @host@
host_alias = @host_alias@
host_cpu = @host_cpu@
host_os = @host_os@
host_vendor = @host_vendor@
htmldir = @htmldir@
includedir = @includedir@
infodir = @infodir@
install_sh = @install_sh@
libdir = @libdir@
libexecdir = @libexecdir@
localedir = @localedir@
localstatedir = @localstatedir@
mandir = @mandir@
mkdir_p = @mkdir_p@
oldincludedir = @oldincludedir@
pdfdir = @pdfdir@
prefix = @prefix@
program_transform_name = @program_transform_name@
psdir = @psdir@
sbindir = @sbindir@
sharedstatedir = @sharedstatedir@
srcdir = @srcdir@
sysconfdir = @sysconfdir@
target_alias = @target_alias@
top_builddir = @top_builddir@
top_srcdir = @top_srcdir@

### $Id: Makefile.am,v 1.2 2009/04/29 13:53:25 ak Exp $
### Makefile.am -- makefile(GNU) for sendmail-virtualmailbox/build
SM_VERSION = 8.14.5
PM_VERSION = 3.22
MD_VERSION = 2.5.3
MX_VERSION = 12.4
SI_VERSION = 1.0.0
SM_ARCHIVE = sendmail.$(SM_VERSION).tar.gz
PM_ARCHIVE = procmail-$(PM_VERSION).tar.gz
MD_ARCHIVE = maildrop-$(MD_VERSION).tar.gz
MX_ARCHIVE = mailx-$(MX_VERSION).tar.bz2
SI_ARCHIVE = sid-milter-$(SI_VERSION).tar.gz
SM_DISTDIR = sendmail-$(SM_VERSION)
PM_DISTDIR = procmail-$(PM_VERSION)
MD_DISTDIR = maildrop-$(MD_VERSION)
MX_DISTDIR = mailx-$(MX_VERSION)
SI_DISTDIR = sid-milter-$(SI_VERSION)

#SM_DISTURL = ftp://ftp.sendmail.org/pub/sendmail/$(SM_ARCHIVE)
#PM_DISTURL = ftp://ftp.ring.gr.jp/pub/net/mail/procmail/$(PM_ARCHIVE)
SM_DISTURL = http://dl.dropbox.com/u/8413459/$(SM_ARCHIVE)
PM_DISTURL = http://dl.dropbox.com/u/8413459/$(PM_ARCHIVE)
MD_DISTURL = http://dl.dropbox.com/u/8413459/$(MD_ARCHIVE)
MX_DISTURL = http://dl.dropbox.com/u/8413459/$(MX_ARCHIVE)
SI_DISTURL = http://dl.dropbox.com/u/8413459/$(SI_ARCHIVE)
SM_MAILDIR = /$(shell $(BASENAME) @sysconfdir@)
all: all-am

.SUFFIXES:
$(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
	@for dep in $?; do \
	  case '$(am__configure_deps)' in \
	    *$$dep*) \
	      cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh \
		&& exit 0; \
	      exit 1;; \
	  esac; \
	done; \
	echo ' cd $(top_srcdir) && $(AUTOMAKE) --foreign  build/Makefile'; \
	cd $(top_srcdir) && \
	  $(AUTOMAKE) --foreign  build/Makefile
.PRECIOUS: Makefile
Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
	@case '$?' in \
	  *config.status*) \
	    cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh;; \
	  *) \
	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe)'; \
	    cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe);; \
	esac;

$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh

$(top_srcdir)/configure:  $(am__configure_deps)
	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
$(ACLOCAL_M4):  $(am__aclocal_m4_deps)
	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
tags: TAGS
TAGS:

ctags: CTAGS
CTAGS:


distdir: $(DISTFILES)
	@srcdirstrip=`echo "$(srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	list='$(DISTFILES)'; \
	  dist_files=`for file in $$list; do echo $$file; done | \
	  sed -e "s|^$$srcdirstrip/||;t" \
	      -e "s|^$$topsrcdirstrip/|$(top_builddir)/|;t"`; \
	case $$dist_files in \
	  */*) $(MKDIR_P) `echo "$$dist_files" | \
			   sed '/\//!d;s|^|$(distdir)/|;s,/[^/]*$$,,' | \
			   sort -u` ;; \
	esac; \
	for file in $$dist_files; do \
	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
	  if test -d $$d/$$file; then \
	    dir=`echo "/$$file" | sed -e 's,/[^/]*$$,,'`; \
	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
	    fi; \
	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
	  else \
	    test -f $(distdir)/$$file \
	    || cp -p $$d/$$file $(distdir)/$$file \
	    || exit 1; \
	  fi; \
	done
check-am: all-am
check: check-am
all-am: Makefile
installdirs:
install: install-am
install-exec: install-exec-am
install-data: install-data-am
uninstall: uninstall-am

installcheck: installcheck-am
install-strip:
	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
	  `test -z '$(STRIP)' || \
	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
mostlyclean-generic:

clean-generic:

distclean-generic:
	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)

maintainer-clean-generic:
	@echo "This command is intended for maintainers to use"
	@echo "it deletes files that may require special tools to rebuild."
clean: clean-am

distclean-am: clean-am distclean-generic

dvi: dvi-am

dvi-am:

html: html-am

info: info-am

info-am:

install-data-am:

install-dvi: install-dvi-am

install-exec-am:

install-html: install-html-am

install-info: install-info-am

install-man:

install-pdf: install-pdf-am

install-ps: install-ps-am

installcheck-am:

maintainer-clean: maintainer-clean-am
	-rm -f Makefile
maintainer-clean-am: distclean-am maintainer-clean-generic

mostlyclean: mostlyclean-am

mostlyclean-am: mostlyclean-generic

pdf: pdf-am

pdf-am:

ps: ps-am

ps-am:

uninstall-am:

.MAKE: install-am install-strip

.PHONY: all all-am check check-am clean clean-generic distclean \
	distclean-generic distdir dvi dvi-am html html-am info info-am \
	install install-am install-data install-data-am install-dvi \
	install-dvi-am install-exec install-exec-am install-html \
	install-html-am install-info install-info-am install-man \
	install-pdf install-pdf-am install-ps install-ps-am \
	install-strip installcheck installcheck-am installdirs \
	maintainer-clean maintainer-clean-generic mostlyclean \
	mostlyclean-generic pdf pdf-am ps ps-am uninstall uninstall-am


all-am: procmail maildrop sendmail mailx sid-milter
install-am: install-procmail install-maildrop install-sendmail install-mailx install-sid-milter

procmail: get-procmail build-procmail
maildrop: get-maildrop build-maildrop
sendmail: get-sendmail build-sendmail build-sendmail-cf
mailx: get-mailx build-mailx
sid-milter: get-sid-milter build-sid-milter

get-procmail: $(PM_DISTDIR)
$(PM_DISTDIR):
	mkdir -p archive/
	test -f archive/$(PM_ARCHIVE) && $(CP) archive/$(PM_ARCHIVE) . || $(WGET) $(PM_DISTURL)
	test -f $(PM_ARCHIVE)
	$(CP) $(PM_ARCHIVE) ./archive/
	$(GUNZIP) -dc $(PM_ARCHIVE) | $(TAR) xf -

patch-procmail: $(PM_DISTDIR)
	if [ -f "./procmail-patch-ok" ]; then \
		true ;\
	else \
		$(CAT) procmail-localconfig.diff | $(SED) \
			-e 's|__PREFIX__|@prefix@|g' \
			-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|__LIBEXECDIR__|@libexecdir@|g' \
			-e 's|__BINDIR__|@bindir@|g' \
			-e 's|__SBINDIR__|@sbindir@|g' \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|\([^:]\)//|\1/|g' > procmail-localconfig.patch ;\
		cd $(PM_DISTDIR) && ( \
			$(PATCH) -p0 < $(BUILDROOT)/build/procmail-localconfig.patch && \
			$(PATCH) -p0 < $(BUILDROOT)/build/procmail-conflict-types-for-getline.patch && \
			$(TOUCH) $(BUILDROOT)/build/procmail-patch-ok \
		) \
	fi

build-procmail: $(PM_DISTDIR) patch-procmail
	if [ -f "./procmail-build-ok" ]; then \
		true ;\
	else \
		cd $(PM_DISTDIR) && $(MAKE) ;\
		$(TOUCH) $(BUILDROOT)/build/procmail-build-ok ;\
	fi

install-procmail: build-procmail
	cd $(PM_DISTDIR) && $(MAKE) install
	$(STRIP) @libexecdir@/formail
	$(STRIP) @libexecdir@/lockfile
	$(STRIP) @libexecdir@/procmail

	test -d @sysconfdir@/rc || $(MKDIR) -p @sysconfdir@/rc
	test -d @localstatedir@/log || $(MKDIR) -p @localstatedir@/log

	if [ -f @localstatedir@/log/procmail-local.log ]; then \
		true ;\
	else \
		$(TOUCH) @localstatedir@/log/procmail-local.log ;\
		$(CHMOD) 0600 @localstatedir@/log/procmail-local.log ;\
	fi

get-maildrop: $(MD_DISTDIR)
$(MD_DISTDIR):
	mkdir -p archive/
	test -f archive/$(MD_ARCHIVE) && $(CP) archive/$(MD_ARCHIVE) . || $(WGET) $(MD_DISTURL)
	test -f $(MD_ARCHIVE)
	$(CP) $(MD_ARCHIVE) ./archive/
	$(GUNZIP) -dc $(MD_ARCHIVE) | $(TAR) xf -

build-maildrop: $(MD_DISTDIR)
	if [ -f "./maildrop-build-ok" ]; then \
		true ;\
	else \
		$(CAT) maildrop-configure.sh | $(SED) \
			-e 's|__PREFIX__|@prefix@|g' \
			-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|__LIBEXECDIR__|@libexecdir@|g' \
			-e 's|__BINDIR__|@bindir@|g' \
			-e 's|__SBINDIR__|@sbindir@|g' \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|\([^:]\)//|\1/|g' > maildrop-configure ;\
		cd $(MD_DISTDIR) && ( /bin/sh $(BUILDROOT)/build/maildrop-configure && $(MAKE) ) ;\
		$(TOUCH) $(BUILDROOT)/build/maildrop-build-ok ;\
	fi

check-virtmail-user:
	id $(VIRTMAILUSER)

install-maildrop: check-virtmail-user build-maildrop
	cd $(MD_DISTDIR) && $(MAKE) install-strip

	test -d @sysconfdir@/rc || $(MKDIR) -p @sysconfdir@/rc
	test -d @localstatedir@/log || $(MKDIR) -p @localstatedir@/log

	if [ -f @localstatedir@/log/maildrop-virtual.log ]; then \
		true ;\
	else \
		$(TOUCH) @localstatedir@/log/maildrop-virtual.log ;\
		$(CHOWN) $(VIRTMAILUSER):root @localstatedir@/log/maildrop-virtual.log ;\
		$(CHMOD) 0600 @localstatedir@/log/maildrop-virtual.log ;\
	fi

get-sendmail: $(SM_DISTDIR)
$(SM_DISTDIR):
	mkdir -p archive/
	test -f archive/$(SM_ARCHIVE) && $(CP) archive/$(SM_ARCHIVE) . || $(WGET) $(SM_DISTURL)
	test -f $(SM_ARCHIVE)
	$(CP) $(SM_ARCHIVE) ./archive
	$(GUNZIP) -dc $(SM_ARCHIVE) | $(TAR) xf -

check-sendmail-user:
	id $(SENDMAILUSER)
	id $(SMSUBMITUSER)

build-sendmail: $(SM_DISTDIR) check-sendmail-user
	if [ -f "./sendmail-build-ok" ]; then \
		true ;\
	else \
		$(CAT) sendmail-site.config.m4 | $(SED) \
			-e 's|__PREFIX__|@prefix@|g' \
			-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|__LIBEXECDIR__|@libexecdir@|g' \
			-e 's|__BINDIR__|@bindir@|g' \
			-e 's|__SBINDIR__|@sbindir@|g' \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e "s|__SMSUBMITUSER__|$(SMSUBMITUSER)|g" \
			-e "s|__SENDMAILUSER__|$(SENDMAILUSER)|g" \
			-e "s|__VIRTMAILUSER__|$(VIRTMAILUSER)|g" \
			-e 's|\([^:]\)//|\1/|g' > site.config.m4 ;\
		$(CP) site.config.m4 $(SM_DISTDIR)/devtools/Site/ ;\
		$(CAT) submit-mc.in | $(SED) \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|\([^:]\)//|\1/|g' > $(SM_DISTDIR)/cf/cf/submit.mc ;\
		cd $(SM_DISTDIR) && ( \
			$(PERL) -i -pe "s|^MAILDIR=.*|MAILDIR=$(SM_MAILDIR)|" cf/cf/Makefile && \
			/bin/sh ./Build -c DESTDIR=@prefix@ && \
			cd ./libmilter && /bin/sh ./Build -c DESTDIR=@prefix@ && \
			$(TOUCH) $(BUILDROOT)/build/sendmail-build-ok ;\
		) ;\
	fi

build-sendmail-cf: $(SM_DISTDIR) sendmail.mc virtmail.m4 sendmail.cf

sendmail.mc:
	$(CAT) sendmail-mc.in | $(SED) \
		-e "s|__TARGET_OSTYPE__|$(TARGET_OSTYPE)|g" \
		-e "s|__TARGET_HOSTNAME__|$(TARGET_HOSTNAME)|g" \
		-e "s|__TARGET_DOMAINNAME__|$(TARGET_DOMAINNAME)|g" \
		-e 's|__PREFIX__|@prefix@|g' \
		-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
		-e 's|__DATAROOTDIR__|@datarootdir@|g' \
		-e 's|__LIBEXECDIR__|@libexecdir@|g' \
		-e 's|__BINDIR__|@bindir@|g' \
		-e 's|__SBINDIR__|@sbindir@|g' \
		-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
		-e 's|__DATAROOTDIR__|@datarootdir@|g' \
		-e "s|__SMSUBMITUSER__|$(SMSUBMITUSER)|g" \
		-e "s|__SENDMAILUSER__|$(SENDMAILUSER)|g" \
		-e "s|__VIRTMAILUSER__|$(VIRTMAILUSER)|g" \
		-e 's|\([^:]\)//|\1/|g' > $@
	$(CP) sendmail.mc $(SM_DISTDIR)/cf/cf/$(TARGET_FQDN).mc

virtmail.m4:
	$(CAT) $@.in | $(SED) \
		-e 's|__PREFIX__|@prefix@|g' \
		-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
		-e 's|__DATAROOTDIR__|@datarootdir@|g' \
		-e 's|__LIBEXECDIR__|@libexecdir@|g' \
		-e 's|__BINDIR__|@bindir@|g' \
		-e 's|__SBINDIR__|@sbindir@|g' \
		-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
		-e 's|__DATAROOTDIR__|@datarootdir@|g' \
		-e "s|__SMSUBMITUSER__|$(SMSUBMITUSER)|g" \
		-e "s|__SENDMAILUSER__|$(SENDMAILUSER)|g" \
		-e "s|__VIRTMAILUSER__|$(VIRTMAILUSER)|g" \
		-e 's|\([^:]\)//|\1/|g' > $@

sendmail.cf: $(SM_DISTDIR) sendmail.mc virtmail.m4
	$(CP) virtmail.m4 $(SM_DISTDIR)/cf/mailer/
	$(M4) $(SM_DISTDIR)/cf/m4/cf.m4 sendmail.mc > $@
	$(CP) sendmail.cf $(SM_DISTDIR)/cf/cf/$(TARGET_FQDN).cf

install-sendmail: $(SM_DISTDIR)
	$(MKDIR) -p @prefix@
	$(MKDIR) -p @sysconfdir@
	$(MKDIR) -p @datarootdir@
	$(MKDIR) -p @datarootdir@/data
	$(MKDIR) -p @datarootdir@/example
	$(MKDIR) -p @libexecdir@
	$(MKDIR) -p @bindir@
	$(MKDIR) -p @sbindir@
	$(MKDIR) -p @localstatedir@
	$(MKDIR) -p @localstatedir@/hoststat
	$(MKDIR) -p @localstatedir@/tmp
	$(MKDIR) -p @prefix@/include
	$(MKDIR) -p @localstatedir@/adm/sm.bin
	cd $(SM_DISTDIR) && ( /bin/sh ./Build install DESTDIR=@prefix@ )
	cd $(SM_DISTDIR)/libmilter && /bin/sh ./Build install DESTDIR=@prefix@

	test -f @sbindir@/sm-mta || $(LN) -s @sbindir@/sendmail @sbindir@/sm-mta
	for L in newaliases hoststat purgestat mailq; do \
		$(LN) -fs @sbindir@/sendmail @bindir@/$$L; \
	done
	test -f @sysconfdir@/aliases || \
		$(INSTALL) -o root -g root -vpm 0644 $(SM_DISTDIR)/sendmail/aliases @sysconfdir@/
	$(CP) -Rp $(SM_DISTDIR)/cf @datarootdir@/cf
	$(CP) -Rp $(SM_DISTDIR)/include/* @prefix@/include/

install-cf: sendmail.cf
	$(INSTALL) -vpm 0644 -g root -o root sendmail.mc @sysconfdir@/
	$(INSTALL) -vpm 0644 -g root -o root sendmail.cf @sysconfdir@/
	$(INSTALL) -vpm 0644 -g root -o root $(SM_DISTDIR)/cf/cf/submit.mc @sysconfdir@/
	$(INSTALL) -vpm 0644 -g root -o root $(SM_DISTDIR)/cf/cf/submit.cf @sysconfdir@/

get-mailx: $(MX_DISTDIR)
$(MX_DISTDIR):
	mkdir -p archive/
	test -f archive/$(MX_ARCHIVE) && $(CP) archive/$(MX_ARCHIVE) . || $(WGET) $(MX_DISTURL)
	test -f $(MX_ARCHIVE)
	$(CP) $(MX_ARCHIVE) ./archive
	$(BUNZIP2) -dc $(MX_ARCHIVE) | $(TAR) xf -

patch-mailx: $(MX_DISTDIR)
	if [ -f "./mailx-patch-ok" ]; then \
		true ;\
	else \
		$(CAT) mailx-localconfig.diff | $(SED) \
			-e 's|__PREFIX__|@prefix@|g' \
			-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|__LIBEXECDIR__|@libexecdir@|g' \
			-e 's|__BINDIR__|@bindir@|g' \
			-e 's|__SBINDIR__|@sbindir@|g' \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|\([^:]\)//|\1/|g' > mailx-localconfig.patch ;\
		cd $(MX_DISTDIR) && ( \
			$(PATCH) -p0 < $(BUILDROOT)/build/mailx-localconfig.patch && \
			$(TOUCH) $(BUILDROOT)/build/mailx-patch-ok \
		) \
	fi

build-mailx: $(MX_DISTDIR) patch-mailx
	if [ -f "./mailx-build-ok" ]; then \
		true ;\
	else \
		cd $(MX_DISTDIR) && $(MAKE) ;\
		$(TOUCH) $(BUILDROOT)/build/mailx-build-ok ;\
	fi

install-mailx: build-mailx
	cd $(MX_DISTDIR) && $(MAKE) install
	test -x @bindir@/mailx && $(LN) -fs @bindir@/mailx @bindir@/mail

get-sid-milter: $(SI_DISTDIR)
$(SI_DISTDIR):
	mkdir -p archive/
	test -f archive/$(SI_ARCHIVE) && $(CP) archive/$(SI_ARCHIVE) . || $(WGET) $(SI_DISTURL)
	test -f $(SI_ARCHIVE)
	$(CP) $(SI_ARCHIVE) ./archive
	$(GUNZIP) -dc $(SI_ARCHIVE) | $(TAR) xf -

patch-sid-milter: $(SI_DISTDIR)
	if [ -f "./sid-milter-patch-ok" ]; then \
		true ;\
	else \
		$(CAT) sid-milter-localconfig.diff | $(SED) \
			-e 's|__PREFIX__|@prefix@|g' \
			-e 's|__SYSCONFDIR__|@sysconfdir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e 's|__LIBEXECDIR__|@libexecdir@|g' \
			-e 's|__BINDIR__|@bindir@|g' \
			-e 's|__SBINDIR__|@sbindir@|g' \
			-e 's|__LOCALSTATEDIR__|@localstatedir@|g' \
			-e 's|__DATAROOTDIR__|@datarootdir@|g' \
			-e "s|__SMSUBMITUSER__|$(SMSUBMITUSER)|g" \
			-e "s|__SENDMAILUSER__|$(SENDMAILUSER)|g" \
			-e "s|__VIRTMAILUSER__|$(VIRTMAILUSER)|g" \
			-e 's|\([^:]\)//|\1/|g' > sid-milter-localconfig.patch ;\
		cd $(SI_DISTDIR) && ( \
			$(PATCH) -p0 < $(BUILDROOT)/build/sid-milter-localconfig.patch && \
			$(TOUCH) $(BUILDROOT)/build/sid-milter-patch-ok \
		) \
	fi

build-sid-milter: $(SI_DISTDIR) patch-sid-milter
	if [ -f "./sid-milter-build-ok" ]; then \
		true ;\
	else \
		cd $(SI_DISTDIR) && /bin/sh ./Build -c DESTDIR=@prefix@ ;\
		$(TOUCH) $(BUILDROOT)/build/sid-milter-build-ok ;\
	fi

install-sid-milter: build-sid-milter
	cd $(SI_DISTDIR) && /bin/sh ./Build install DESTDIR=@prefix@

.PHONY: clean
clean-am:
	rm -rf $(PM_DISTDIR)
	rm -rf $(MD_DISTDIR)
	rm -rf $(SM_DISTDIR)
	rm -rf $(MX_DISTDIR)
	rm -rf $(SI_DISTDIR)
	rm -f ./procmail-localconfig.patch
	rm -f ./mailx-localconfig.patch
	rm -f ./sid-milter-localconfig.patch
	rm -f ./maildrop-configure
	rm -f ./site.config.m4
	rm -f ./virtmail.m4

distclean: clean
	rm -f $(PM_ARCHIVE)
	rm -f $(MD_ARCHIVE)
	rm -f $(SM_ARCHIVE)
	rm -f $(MX_ARCHIVE)
	rm -f $(SI_ARCHIVE)
	rm -f ./*-ok
	rm -fr ./archive/*
# Tell versions [3.59,3.63) of GNU make to not export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:
